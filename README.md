# Minecraft Server Quickstart
Script utilities for launching a Minecraft server on Linux in a screen instance.

## Dependencies

- `bash` shell and a terminal emulator

### PaperMC Launch Script (runs/papermc.sh)

- `curl` and `jq` (jqlang) for utilizing the PaperMC download API.
- OpenJDK or other JVM for running Minecraft

### Forge Launch Script (runs/forge.sh)

- Forge server installation
- OpenJDK or other JVM for running Minecraft

### Backup scripts (backup.sh, tasks/autobackup.sh)

- `rdiff-backup` for backups, with the pre-201 CLI
  - If your distro no longer supplies pre-201 CLI rdiff-backup, modify quickstart.env to use the commented-out rdiff201 option, and ensure BACKUP_DIRECTORY is not set to a subdirectory of install folder.
  - quickstart.env can also be modified to use either `rsync` or `scp` for backup, if preferable.

### Screen emulator scripts (attach.sh, start.sh, stop.sh, kill.sh, stuff.sh, restart.sh)

- `screen` screen emulator for Linux
  - If you do not have `screen` or wish to use this quickstart without `screen`, you may use the run.sh script instead.

## Starting your Minecraft server

Make sure to mark each script you wish to use as executable in an enable shell:
```console
#> chmod u+x,g+x *.sh
#> chmod u+x,g+x tasks/*.sh
#> chmod u+x,g+x runs/*.sh
```

This quickstart is configured out of the box to download the latest build of the latest version of the PaperMC minecraft server.
If you do not wish to use PaperMC, you will need to configure your **quickstart.env** file.
This file can be generated by executing the **env.sh** script.

```console
$> ./env.sh
```

### quickstart.env File Contents
```sh
# This file defines the environment variables available to scripts which source env.sh.
# Environment variables cannot contain spaces or periods in their names.
# You may define your own environment variables at the top of this file.

# Add your custom environment variables here.

##### DO NOT DELETE ENTRIES BELOW THIS LINE #####

# Common environment variables
SCREEN=minecraft_server
RUNAS=isabel

# start.sh options
LAUNCH_CMD="./run.sh"

# run.sh options
RUN_SCRIPT=papermc      # Must match the filename of a script in the runs/ folder, sans extension
RUN_SCRIPT_ARGS=--nogui # These arguments are passed directly to the script file by run.sh
RESTART_WAIT_TIME=10s

# Common arguments for all runs/ scripts
JVM=

# runs/papermc.sh options
PAPERCRAFT_JAR=dynamic    # Set this to dynamic to download the latest build from Papers API, or set to a specific jar file.
PAPERCRAFT_VERSION=latest # If PAPERCRAFT_JAR is set to dynamic, this will determine which Minecraft version is downloaded. Set to latest to use the latest version.

# runs/forge.sh options
FORGE_ARGS=@libraries/net/minecraftforge/forge/1.19.2-43.4.16/unix_args.txt # Set this to the args file from your forge installs default script.

# backup.sh options
# Select one BACKUP_METHOD from the options below.
BACKUP_METHOD=rdiff       # Legacy rdiff-backup CLI. Uses include-filelist.txt to designate included and excluded files and folders. Only enable if your rdiff-backup install supports the deprecated pre-201 CLI.
#BACKUP_METHOD=rdiff201   # New rdiff-backup CLI. Use an external or network folder for BACKUP_DIRECTORY, as include-filelist is no longer used.
#BACKUP_METHOD=rsync      # Use rsync instead of rdiff-backup. Use an external or network folder for BACKUP_DIRECTORY, as no files are excluded.
#BACKUP_METHOD=scp        # Use secure copy for the backup. Use an external or network folder for BACKUP_DIRECTORY, as no files will be excluded.
BACKUP_DIRECTORY=backups/ # Destination folder for backups. If using rsync or rdiff201, use a folder outside the current directory.
```

## Custom Run Scripts

You may add custom run script definitions to the **runs** directory. Two are provided by default, **forge.sh** and **papermc.sh**.
Custom scripts and arguments can be configured in the **quickstart.env** file:
```sh
...
RUN_SCRIPT=papermc.sh # Change this to the name of the custom script file
RUN_SCRIPT_ARGS=--nogui # These arguments are passed directly to the script file by run.sh
...
```

### Script Example

Here is an example of a very simple script for running the standard Minecraft server.jar.

#### runs/minecraft.sh
```sh
#!/bin/bash

echo 'Launching default Minecraft server jar...'
$JVM -server @user_jvm_args -jar $SERVER_JAR "$@"
```

#### quickstart.env
```sh
...
RUN_SCRIPT=minecraft
RUN_SCRIPT_ARGS=--nogui
...
# runs/minecraft.sh properties
SERVER_JAR=server.jar
...
```

#### File Structure
```
runs/
  + minecraft.sh
server.jar
run.sh
```
